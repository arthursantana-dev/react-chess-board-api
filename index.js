const express = require('express')
const app = express()
const port = 3003
const cors = require("cors")
const Database = require('./db')

// require("dotenv").config()

app.use(express.json())

app.use(cors({ origin: "*" }))

// const mysql = require("mysql")

// require("dotenv").config()

// const connection = mysql.createConnection({
//   host: "localhost",
//   user: "root",
//   port: process.env.DB_PORT,
//   password: process.env.DB_PASSWORD,
//   database: "chess"
// })

const Db = new Database()

app.post('/', async (req, res) => {
    console.log(req.body);
    console.log("é post");
    
    Db.insert(req.body)
})

app.get('/', async (req, res) => {

    const gamesDb = await Db.select()

    console.log(gamesDb);

    console.log("Acesso em './'");

    const games = [

        {
            notation: ["g4 ", "f5 ", "½-½"],

            moves: [[[6, 6], [4, 6]], [[1, 5], [3, 5]], [[0.5, 0], [0.5, 0]]],

            gameImage: [[[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 1], [4, 2, 3, 5, 6, 3, 2, 4]], [[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 1], [4, 2, 3, 5, 6, 3, 2, 4]], [[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 1], [4, 2, 3, 5, 6, 3, 2, 4]]]
        },

        {
            notation: ["g4 ", "f5 ", "½-½"],

            moves: [[[6, 6], [4, 6]], [[1, 5], [3, 5]], [[0.5, 0], [0.5, 0]]],

            gameImage: [[[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 1], [4, 2, 3, 5, 6, 3, 2, 4]], [[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 1], [4, 2, 3, 5, 6, 3, 2, 4]], [[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 1], [4, 2, 3, 5, 6, 3, 2, 4]]]
        },

    ]

    // const game = {
    //   notation: ["g4 ", "f5 ", "½-½"],

    //   moves: [[[6, 6], [4, 6]], [[1, 5], [3, 5]], [[0.5, 0], [0.5, 0]]],

    //   gameImage: [[[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 1], [4, 2, 3, 5, 6, 3, 2, 4]], [[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 1, 1], [4, 2, 3, 5, 6, 3, 2, 4]], [[10, 8, 9, 11, 12, 9, 8, 10], [7, 7, 7, 7, 7, 7, 7, 7], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 1, 0], [0, 0, 0, 0, 0, 0, 0, 0], [1, 1, 1, 1, 1, 1, 0, 1], [4, 2, 3, 5, 6, 3, 2, 4]]]
    // }

    res.send(gamesDb)

})

app.listen(port, async () => {
    console.log(`Example app listening on port ${port}.`)

    await Db.connect()
    // Db.select()

    // const db = connection.connect(error => {
    //   if (error) {
    //     throw error
    //   }

    //   console.log("conectado :)");

    // })

})